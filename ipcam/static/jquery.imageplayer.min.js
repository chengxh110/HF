if(typeof(jQuery)=="undefined"){alert("jQuery library was not found.")}(function(a){a.fn.extend({imagePlayer:function(){options=a.imagePlayer.settings;options.stageWidth=play_data.width;options.stageHeight=play_data.height;options.delay=1/play_data.rate;return this.each(function(){try{new a.imagePlayer(this,options)}catch(b){console.error(b)}})}});a.imagePlayer=function(l,w){var P=w;var u=a(l);var d=[];var m=[];var L=[];var f;var v=null;var N,p,y,x,A,n,c,s,F,o,k,E,e=null;var j=0;var Q=P.pauseOnHover;var O;var M=0;var H=null;a.each(play_data.data.video,function(i,T){var S="http://"+file_host+":20131/snapshot?camid="+play_data.camid+"&snapid="+T+"&tick="+play_data.tick+"&hid="+play_data.hid;d.push(S);m.push(I(T))});if(d.length==0){throw"No images found!"}z();if(P.autoStart===true){R()}else{r(d[0])}D();function I(i){return new Date(parseInt(i)*1000).toLocaleString()}function z(){N=a("<div>").addClass("img_player");p=a("<div>").addClass("stage");y=a("<div>").addClass("controls");x=a("<a>").attr("href","#").addClass("start");A=a("<a>").attr("href","#").addClass("prev");n=a("<a>").attr("href","#");c=a("<a>").attr("href","#").addClass("next");s=a("<a>").attr("href","#").addClass("end");F=a("<div>").addClass("scrubber");o=a("<a>").attr("href","#");k=a("<span>").addClass("frame_count");E=a("<div>").addClass("caption");N.css({width:P.stageWidth+"px",height:P.stageHeight+40+"px"});p.css({width:P.stageWidth+"px",height:P.stageHeight+"px"});y.css({width:P.stageWidth+"px"});F.css({width:Math.floor(P.stageWidth-267)+"px"});(P.autoStart===true)?n.addClass("pause"):n.addClass("play");N.append(p.append(E)).append(y.append(x).append(A).append(n).append(c).append(s).append(F.append(o)).append(k));u.hide().after(N);O=F.width()/d.length}function D(){p.bind("mouseenter",function(i){b(i,this)}).bind("mouseleave",function(i){t(i,this)});n.bind("click",function(i){G(i,this)});A.bind("click",function(i){C(i,this)});c.bind("click",function(i){q(i,this)});x.bind("click",function(i){g(i,this)});s.bind("click",function(i){h(i,this)});F.bind("click",function(i){J(i,this)})}function r(S){if(!L[M]){var i=P.stageWidth;var U=P.stageHeight;var T={src:S,alt:"Slide "+(M+1),width:i,height:U};if(e===null){e=a("<img>").attr(T);p.append(e);f=e}else{if(e!=f){e.replaceWith(f);e=f}e.attr(T)}e.waitForImages(a.noop,a.noop,true);L[M]=e.clone()}else{e.replaceWith(L[M]);e=L[M]}K(M+1);k.html(M+1+"/"+d.length)}function K(i){if(P.captions===false){return}E.html(m[i])}function R(){clearTimeout(H);if(P.loop===true){if(M>d.length-1){M=0;o.stop(true,true);o.css("left","0")}}if(M<d.length){B(d[M])}M++}function B(i){r(i);j=parseFloat(o.css("left"));var S=Math.floor((M+1)*O)-j;o.stop(true,true);o.animate({left:"+="+S+"px"},P.delay*1000,"linear");H=setTimeout(R,P.delay*1000)}function b(S,i){if(Q===true&&n.attr("class")==="pause"){clearTimeout(H);o.stop(true,true)}}function t(S,i){if(Q===true&&n.attr("class")==="pause"){R()}}function G(S,i){S.preventDefault();i=a(i,N);if(i.attr("class")=="pause"){i.attr("class","play");clearTimeout(H);o.stop(true,false);o.css("left",j+"px");M--}else{M++;R();i.attr("class","pause")}}function C(S,i){S.preventDefault();i=a(i,N);clearTimeout(H);o.stop(true,false);M=(M-1<0)?0:M-1;o.css("left",Math.floor((M+1)*O)+"px");if(n.attr("class")==="pause"){R()}else{r(d[M])}}function q(S,i){S.preventDefault();i=a(i,N);clearTimeout(H);o.stop(true,false);M=(M+1>d.length-1)?d.length-1:M+1;o.css("left",Math.floor((M+1)*O)+"px");if(n.attr("class")==="pause"){R()}else{r(d[M])}}function g(S,i){S.preventDefault();i=a(i,N);clearTimeout(H);o.stop(true,false);M=0;o.css("left","0px");if(n.attr("class")==="pause"){R()}else{r(d[M])}}function h(S,i){S.preventDefault();i=a(i,N);clearTimeout(H);o.stop(true,false);M=d.length-1;o.css("left",Math.floor((M+1)*O)+"px");if(n.attr("class")==="pause"){R()}else{r(d[M])}}function J(U,S){var W,i,T,V;U.preventDefault();S=a(S,N);clearTimeout(H);o.stop(true,false);W=S.offset();i=Math.ceil(U.pageX-W.left);M=Math.floor(i/O);T=Math.abs(Math.floor(M*O)-i);V=Math.abs(Math.floor((M+1)*O)-i);if(M<d.length){if(T<=V){o.css("left",(i-T)+"px")}else{o.css("left",(i+V)+"px");if(M<d.length-1){M++}}if(n.attr("class")==="pause"){R()}else{r(d[M])}}}};a.imagePlayer.settings={stageWidth:640,stageHeight:480,autoStart:true,pauseOnHover:false,delay:1,loop:true,captions:true}})(jQuery);